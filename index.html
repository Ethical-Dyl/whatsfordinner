<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Whats For Dinner?!</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
    }
    
    h1 {
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 20px;
      font-size: 2.5em;
      text-align: center;
    }
    
    .wheel-container {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px 0;
    }
    
    canvas {
      border: 8px solid #fff;
      border-radius: 50%;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: transform 0.4s ease-out;
      background: #fff;
    }
    
    .pointer {
      width: 0;
      height: 0;
      border-left: 25px solid transparent;
      border-right: 25px solid transparent;
      border-bottom: 40px solid #ff4757;
      position: absolute;
      top: -20px;
      z-index: 10;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    }
    
    .controls {
      background: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      margin: 20px;
      text-align: center;
      backdrop-filter: blur(10px);
    }
    
    .filter-section {
      margin-bottom: 20px;
    }
    
    .filter-section h3 {
      margin: 0 0 15px 0;
      color: #333;
      font-size: 1.1em;
    }
    
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      background: #f8f9fa;
      padding: 8px 15px;
      border-radius: 25px;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .checkbox-item:hover {
      background: #e9ecef;
      border-color: #667eea;
    }
    
    .checkbox-item input[type="checkbox"] {
      margin-right: 8px;
      transform: scale(1.2);
    }
    
    .checkbox-item.checked {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    #spinBtn {
      padding: 15px 30px;
      background: linear-gradient(45deg, #ff4757, #ff6b7d);
      color: white;
      border: none;
      font-size: 1.3em;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    #spinBtn:hover:not(:disabled) {
      background: linear-gradient(45deg, #ff3742, #ff5722);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 71, 87, 0.6);
    }
    
    #spinBtn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    #result {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      margin-top: 20px;
      text-align: center;
      backdrop-filter: blur(10px);
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #result.show {
      font-size: 1.8em;
      color: #333;
      font-weight: bold;
    }
    
    #result a {
      color: #667eea;
      text-decoration: none;
      border-bottom: 2px solid transparent;
      transition: border-color 0.3s ease;
    }
    
    #result a:hover {
      border-bottom-color: #667eea;
    }
    
    .meal-count {
      margin-top: 10px;
      font-size: 0.9em;
      color: #666;
      font-style: italic;
    }
    
    @media (max-width: 768px) {
      h1 {
        font-size: 2em;
      }
      
      .controls {
        margin: 10px;
        padding: 20px;
      }
      
      .checkbox-group {
        flex-direction: column;
        align-items: center;
      }
      
      .checkbox-item {
        width: 200px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <h1>üçΩÔ∏è What's for Dinner? üçΩÔ∏è</h1>
  
  <div class="controls">
    <div class="filter-section">
      <h3>‚è∞ Time Filters</h3>
      <div class="checkbox-group">
        <div class="checkbox-item" data-checkbox="under10">
          <input type="checkbox" id="under10">
          <label for="under10">Under 10 Minutes</label>
        </div>
        <div class="checkbox-item" data-checkbox="under30">
          <input type="checkbox" id="under30">
          <label for="under30">Under 30 Minutes</label>
        </div>
        <div class="checkbox-item" data-checkbox="under60">
          <input type="checkbox" id="under60">
          <label for="under60">Under 60 Minutes</label>
        </div>
      </div>
      <div class="meal-count" id="mealCount">20 meals available</div>
    </div>
    
    <button id="spinBtn">üé° Spin the Wheel!</button>
  </div>
  
  <div class="wheel-container">
    <div class="pointer"></div>
    <canvas id="wheel"></canvas>
  </div>
  
  <div id="result">Click "Spin the Wheel" to discover your dinner!</div>

  <script>
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    const spinBtn = document.getElementById('spinBtn');
    const resultDiv = document.getElementById('result');
    const mealCountDiv = document.getElementById('mealCount');
    const checkboxItems = document.querySelectorAll('.checkbox-item');
    
    const allMeals = [
      // 10-minute meals
     
      { name: "BBQ Chicken Tacos", time: 10, link: "https://www.eatingwell.com/recipe/270288/bbq-chicken-tacos-with-red-cabbage-slaw/" },
      { name: "Peanut Noodles", time: 10, link: "https://www.thesavorychopstick.com/recipe/spicy-peanut-noodles/" },
      { name: "Steak Fajita Wraps", time: 10, link: "https://www.juliapacheco.com/steak-fajita-quesadillas/" },
      { name: "Our Beef Taco Bowls", time: 10, link: "" },
      { name: "Spicy Peanut Noodles", time: 10, link: "https://www.thesavorychopstick.com/spicy-peanut-noodles/" },
      { name: "Rotisserie Chicken Salad", time: 10, link: "" },

      
      // 30-minute meals
      { name: "Chicken Taco Bowls", time: 30, link: "https://www.allrecipes.com/recipe/242481/chicken-taco-bowls-with-pinto-beans-and-rice/" },
      { name: "Greek Quesadillas", time: 30, link: "https://damndelicious.net/2016/07/23/greek-quesadillas/" }, 
      { name: "Creamy Garlic Chicken", time: 30, link: "https://www.thesavorychopstick.com/creamy-garlic-chicken/" },
      
      // 60-minute meals
      { name: "Lasagna Soup", time: 45, link: "https://eatinginstantly.com/easy-instant-pot-lasagna-soup/" },
   

      // Over 60 minute meals
      { name: "Korean Beef Bulgogi", time: 180, link: "https://damndelicious.net/2019/04/21/korean-beef-bulgogi/" },
     ];


    let spinning = false;
    let currentRotation = 0;

    // Enhanced checkbox styling
    checkboxItems.forEach(item => {
      const checkbox = item.querySelector('input[type="checkbox"]');
      checkbox.addEventListener('change', () => {
        if (checkbox.checked) {
          item.classList.add('checked');
        } else {
          item.classList.remove('checked');
        }
        updateMealCount();
        drawWheel(getFilteredMeals());
      });
      
      item.addEventListener('click', (e) => {
        if (e.target.type !== 'checkbox') {
          checkbox.checked = !checkbox.checked;
          checkbox.dispatchEvent(new Event('change'));
        }
      });
    });

    function calculateOptimalSize(itemCount) {
      // Dynamic sizing based on number of items and text length
      const minSize = 300;
      const maxSize = 500;
      const baseSize = Math.max(minSize, Math.min(maxSize, 200 + itemCount * 8));
      return baseSize;
    }

    function getTextSize(itemCount) {
      // Adjust text size based on number of items
      if (itemCount <= 8) return 16;
      if (itemCount <= 12) return 14;
      if (itemCount <= 16) return 12;
      return 10;
    }

    function wrapText(text, maxLength) {
      if (text.length <= maxLength) return [text];
      const words = text.split(' ');
      const lines = [];
      let currentLine = '';
      
      for (const word of words) {
        if ((currentLine + word).length <= maxLength) {
          currentLine += (currentLine ? ' ' : '') + word;
        } else {
          if (currentLine) lines.push(currentLine);
          currentLine = word;
        }
      }
      if (currentLine) lines.push(currentLine);
      return lines;
    }

    function drawWheel(items, rotation = 0) {
      if (items.length === 0) return;
      
      const size = calculateOptimalSize(items.length);
      canvas.width = size;
      canvas.height = size;
      
      const center = size / 2;
      const radius = center - 40;
      const arcSize = (2 * Math.PI) / items.length;
      const fontSize = getTextSize(items.length);
      
      ctx.clearRect(0, 0, size, size);
      ctx.save();
      ctx.translate(center, center);
      ctx.rotate(rotation);
      
      // Draw segments
      for (let i = 0; i < items.length; i++) {
        const angle = i * arcSize;
        
        // Draw segment
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.arc(0, 0, radius, angle, angle + arcSize);
        ctx.closePath();
        
        // Vibrant color palette
        const hue = (i * 360 / items.length) % 360;
        const saturation = 70 + (i % 3) * 10;
        const lightness = 55 + (i % 2) * 10;
        ctx.fillStyle = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        ctx.fill();
        
        // Draw border
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // Draw text
        ctx.save();
        ctx.rotate(angle + arcSize / 2);
        ctx.fillStyle = '#fff';
        ctx.font = `bold ${fontSize}px Arial`;
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = 'rgba(0,0,0,0.5)';
        ctx.shadowBlur = 2;
        ctx.shadowOffsetX = 1;
        ctx.shadowOffsetY = 1;
        
        // Handle text wrapping for longer names
        const maxTextLength = Math.max(8, Math.floor(radius / fontSize * 0.8));
        const textLines = wrapText(items[i].name, maxTextLength);
        const textRadius = radius * 0.7;
        
        if (textLines.length === 1) {
          ctx.fillText(textLines[0], textRadius, 0);
        } else {
          const lineHeight = fontSize * 1.2;
          const startY = -(textLines.length - 1) * lineHeight / 2;
          textLines.forEach((line, index) => {
            ctx.fillText(line, textRadius, startY + index * lineHeight);
          });
        }
        
        ctx.restore();
      }
      
      // Draw center circle
      ctx.beginPath();
      ctx.arc(0, 0, 15, 0, 2 * Math.PI);
      ctx.fillStyle = '#333';
      ctx.fill();
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 3;
      ctx.stroke();
      
      ctx.restore();
    }

    function getFilteredMeals() {
      const checkboxes = {
        under10: document.getElementById('under10'),
        under30: document.getElementById('under30'),
        under60: document.getElementById('under60')
      };
      
      const maxTimes = [];
      if (checkboxes.under10.checked) maxTimes.push(10);
      if (checkboxes.under30.checked) maxTimes.push(30);
      if (checkboxes.under60.checked) maxTimes.push(60);
      
      function getFilteredMeals() {
  const checkboxes = {
    under10: document.getElementById('under10'),
    under30: document.getElementById('under30'),
    under60: document.getElementById('under60')
  };

  const maxTimes = [];
  if (checkboxes.under10.checked) maxTimes.push(10);
  if (checkboxes.under30.checked) maxTimes.push(30);
  if (checkboxes.under60.checked) maxTimes.push(60);

  if (maxTimes.length === 0) {
    // No checkboxes selected ‚Äî exclude meals over 60 minutes
    return allMeals.filter(meal => meal.time <= 60);
  }

}

      return allMeals.filter(meal => maxTimes.some(time => meal.time <= time));
    }

    function updateMealCount() {
      const filteredMeals = getFilteredMeals();
      mealCountDiv.textContent = `${filteredMeals.length} meals available`;
    }

    function spinWheel() {
      if (spinning) return;
      
      const meals = getFilteredMeals();
      if (meals.length === 0) {
        resultDiv.textContent = "No meals match your filters! Try unchecking some options.";
        resultDiv.className = "show";
        return;
      }

      spinning = true;
      spinBtn.disabled = true;
      resultDiv.textContent = "Spinning...";
      resultDiv.classList.remove("show");
      
      const selectedIndex = Math.floor(Math.random() * meals.length);
      const arcSize = (2 * Math.PI) / meals.length;
      
      // Calculate target rotation
      const spins = 5 + Math.random() * 3; // 5-8 full rotations
      const targetAngle = (Math.PI / 2) - (arcSize * selectedIndex + arcSize / 2);
      const targetRotation = currentRotation + (2 * Math.PI * spins) + targetAngle;
      
      const duration = 3000 + Math.random() * 2000; // 3-5 seconds
      const startTime = performance.now();
      const startRotation = currentRotation;

      function animate(time) {
        const elapsed = time - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // Enhanced easing function for more realistic spin
        const easeProgress = 1 - Math.pow(1 - progress, 4);
        currentRotation = startRotation + (targetRotation - startRotation) * easeProgress;
        
        drawWheel(meals, currentRotation);
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          const finalMeal = meals[selectedIndex];
          resultDiv.innerHTML = `üéâ Tonight's Dinner: <a href="${finalMeal.link}" target="_blank">${finalMeal.name}</a> (${finalMeal.time} min)`;
          resultDiv.classList.add("show");
          spinning = false;
          spinBtn.disabled = false;
        }
      }

      requestAnimationFrame(animate);
    }

    // Initialize
    spinBtn.addEventListener('click', spinWheel);
    updateMealCount();
    drawWheel(getFilteredMeals());
  </script>
</body>
</html>
